# -----------------------------------------------------
# 解决 Problem 1.21 (a) : n = 500 (大样本)
# -----------------------------------------------------

# 0. (可选) 设置一个随机种子，这样你每次运行都能得到相同的结果
set.seed(123)

# 1. “Simulate a series of n = 500...” (模拟 n=500 的序列)
#    这就是 Example 1.9 的公式
w_500 <- rnorm(10000, 0, 1) # 生成 10000 个白噪声点
v_500 <- filter(w_500, 
                sides = 2, 
                filter = rep(1/3, 3))

# 2. “compute the sample ACF, p(h), to lag 20” (计算样本 ACF)
#    我们将同时计算并“画出”ACF图
acf_500 <- acf(v_500, 
               lag.max = 20, 
               na.action = na.pass, 
               main = "Problem 1.21(a): n = 500 (大样本)")

# -----------------------------------------------------
# 解决 Problem 1.21 (b) : n = 50 (小样本)
# -----------------------------------------------------

# 1. “Repeat part (a) using only n = 50” (用 n=50 重复)
set.seed(456) # 换一个种子
w_50 <- rnorm(50, 0, 1) # 只生成 50 个点
v_50 <- filter(w_50, 
               sides = 2, 
               filter = rep(1/3, 3))

# 2. 计算并画出 n=50 的 ACF 图
acf_50 <- acf(v_50, 
              lag.max = 20, 
              na.action = na.pass, 
              main = "Problem 1.21(b): n = 50 (小样本)")

# -----------------------------------------------------
# 比较：
# (a) 部分的图 (n=500) 应该非常“干净”，lag 3 之后几乎为 0
# (b) 部分的图 (n=50) 应该非常“杂乱”，lag 3 之后也可能有很多“伪”相关性
# -----------------------------------------------------






